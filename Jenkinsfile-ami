pipeline {
  agent any
 
  tools {nodejs "node"}
  
  parameters {
    string(name: 'name', description: 'Filename that bundles were saved as')
  }
 
  stages {
    stage('Packer build script') {
        steps {
           step([  $class: 'CopyArtifact',
                  filter: '${params.name}.zip',
                  fingerprintArtifacts: true,
                  projectName: 'nodejs-template'
            ])
            unzip zipFile: '${params.name}.zip', dir: './bundle'
            sh 'packer build bundle/.pipeline/packer.json'
        }
    }
  }
}
